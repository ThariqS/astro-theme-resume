<script is:inline>
	// Get site mode from URL parameter (personal = light, professional = dark)
	function getSiteMode() {
		const params = new URLSearchParams(window.location.search)
		const mode = params.get('mode')
		if (mode === 'personal' || mode === 'professional') {
			return mode
		}
		return 'personal' // default to personal mode
	}

	// Get theme based on site mode (personal = light, professional = dark)
	function getThemeFromMode() {
		const mode = getSiteMode()
		return mode === 'personal' ? 'light' : 'dark'
	}

	function setTheme(newTheme) {
		if (newTheme !== 'light' && newTheme !== 'dark') {
			return console.log(`Invalid theme value '${newTheme}' received. Expected 'light' or 'dark'.`)
		}

		const root = document.documentElement

		if (newTheme === 'dark' && root.classList.contains('dark')) {
			return
		} else if (newTheme === 'light' && !root.classList.contains('dark')) {
			return
		}

		root.classList.toggle('dark')
	}

	// Initial Setup
	setTheme(getThemeFromMode())

	// View Transitions hook to restore theme
	document.addEventListener('astro:after-swap', () => setTheme(getThemeFromMode()))

	// Listen for theme-change custom event (from mode toggle)
	document.addEventListener('theme-change', (e) => {
		setTheme(e.detail.theme)
	})
</script>
